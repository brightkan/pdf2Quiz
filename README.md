# PDF Quiz Generator

A Django application that generates quizzes from PDF documents using LangChain and OpenAI, designed to help students ace their real exams by providing targeted practice with customized questions.

## Features

- Upload a PDF document
- Choose the number of questions (1-50)
- Select difficulty level (easy, medium, hard)
- Generate a multiple-choice quiz based on the PDF content

## Installation

1. Clone the repository
2. Create a virtual environment:
   ```bash
   python -m venv venv
   source venv/bin/activate  # On Windows: venv\Scripts\activate
   ```
3. Install dependencies:
   ```bash
   pip install django langchain langchain-community openai PyPDF2 python-dotenv
   ```

## Configuration

### OpenAI API Key

This application requires an OpenAI API key to function. You can set it up in one of the following ways:

1. **Environment Variable (Recommended)**:
   Set the `OPENAI_API_KEY` environment variable:

   ```bash
   # On Unix/Linux/macOS
   export OPENAI_API_KEY='your-api-key-here'

   # On Windows
   set OPENAI_API_KEY=your-api-key-here
   ```

   Alternatively, you can use the provided `.env` file:

   - Copy `.env.example` to `.env` (or use the existing `.env` file)
   - Edit the `.env` file and replace `your-api-key-here` with your actual OpenAI API key

2. **Settings File (For Development Only)**:
   You can directly set the API key in `project/settings.py`:

   ```python
   OPENAI_API_KEY = 'your-api-key-here'
   ```

   **Note**: This method is not recommended for production as it exposes your API key in the code.

## Running the Application

1. Start the Django development server:
   ```bash
   python manage.py runserver
   ```

2. Open your browser and navigate to `http://127.0.0.1:8000/`

3. Upload a PDF, select the number of questions and difficulty level, and generate your quiz!

## Docker Setup

This application can be run using Docker for both development and production environments.

### Quick Start with Docker

1. Make sure you have Docker and Docker Compose installed
2. Clone the repository
3. Create a `.env` file with your OpenAI API key
4. Run the application with Docker Compose:
   ```bash
   docker-compose up
   ```
5. Open your browser and navigate to `http://localhost:8000/`

The Docker Compose setup includes:
- Django web application
- PostgreSQL database
- Redis for caching and Celery
- Celery worker for background tasks (automatically started)

For detailed instructions on setting up Docker for development and production, see [DOCKER.md](DOCKER.md).

## Notes

- The application limits the PDF content to approximately 3000 characters to avoid token overload with the OpenAI API.
- The application has been optimized for memory efficiency, allowing it to handle larger PDFs without running out of memory.
- Memory optimization techniques include streaming PDF processing, generator-based text chunking, and efficient resource management.
- For detailed information about memory optimizations, see [docs/memory_optimization.md](docs/memory_optimization.md).
- The Docker setup includes PostgreSQL for database and Redis for caching and background tasks.

## Project Structure

```
.
├── core/
│   ├── migrations/
│   │   ├── 0001_initial.py
│   │   ├── 0002_tokenusage.py
│   │   ├── 0003_quiz_question.py
│   │   └── 0004_uploadedpdf_extracted_text.py
│   ├── static/
│   │   └── core/
│   │       └── css/
│   │           └── styles.css
│   ├── templates/
│   │   ├── form.html
│   │   ├── progress.html
│   │   ├── quiz.html
│   │   └── results.html
│   ├── templatags/
│   │   └── custom_filters.py
│   ├── __init__.py
│   ├── admin.py
│   ├── apps.py
│   ├── forms.py
│   ├── models.py
│   ├── quiz_generator.py
│   ├── tasks.py
│   ├── tests.py
│   ├── test_memory_optimization.py
│   └── views.py
├── docs/
│   └── memory_optimization.md
├── media/
├── nginx/
│   └── nginx.conf
├── project/
│   ├── __init__.py
│   ├── asgi.py
│   ├── celery.py
│   ├── settings.py
│   ├── urls.py
│   └── wsgi.py
├── .env.example
├── .env.prod.example
├── .gitignore
├── db.sqlite3
├── docker-compose.prod.yml
├── docker-compose.yml
├── DOCKER.md
├── Dockerfile
├── gemini.md
├── manage.py
├── README.md
└── requirements.txt
```

### Documentation

*   **`core/`**: This is the main application directory.
    *   **`migrations/`**: Contains database migration files generated by Django.
    *   **`static/`**: Contains static files like CSS, JavaScript, and images.
    *   **`templates/`**: Contains HTML templates for the application.
    *   **`templatetags/`**: Contains custom Django template tags and filters.
    *   **`__init__.py`**: Initializes the `core` directory as a Python package.
    *   **`admin.py`**: Configures the Django admin interface for the app's models.
    *   **`apps.py`**: Defines the application configuration.
    *   **`forms.py`**: Contains forms for user input, such as the quiz generation form.
    *   **`models.py`**: Defines the database models for the application.
    *   **`quiz_generator.py`**: Contains the logic for generating quizzes from PDFs.
    *   **`tasks.py`**: Defines asynchronous tasks to be run with Celery.
    *   **`tests.py`**: Contains tests for the application.
    *   **`test_memory_optimization.py`**: Contains tests for memory optimization.
    *   **`views.py`**: Contains the views that handle requests and return responses.
*   **`docs/`**: Contains additional documentation for the project.
    *   **`memory_optimization.md`**: Detailed documentation of memory optimization techniques implemented in the project.
*   **`media/`**: This directory stores user-uploaded files, such as the PDFs for quiz generation.
*   **`nginx/`**: Contains the Nginx configuration file for deploying the application.
*   **`project/`**: This is the project's configuration directory.
    *   **`__init__.py`**: Initializes the `project` directory as a Python package.
    *   **`asgi.py`**: ASGI config for the project.
    *   **`celery.py`**: Celery configuration.
    *   **`settings.py`**: Contains the settings for the Django project.
    *   **`urls.py`**: Defines the URL patterns for the project.
    *   **`wsgi.py`**: WSGI config for the project.
*   **`.env.example`**: Example environment file for development.
*   **`.env.prod.example`**: Example environment file for production.
*   **`.gitignore`**: Specifies which files and directories to ignore in Git.
*   **`db.sqlite3`**: The SQLite database file for the project.
*   **`docker-compose.prod.yml`**: Docker Compose file for production.
*   **`docker-compose.yml`**: Docker Compose file for development.
*   **`DOCKER.md`**: Documentation for using Docker with the project.
*   **`Dockerfile`**: Defines the Docker image for the application.
*   **`gemini.md`**: Project guidelines for the Gemini CLI.
*   **`manage.py`**: A command-line utility for interacting with the Django project.
*   **`README.md`**: A general README file for the project.
*   **`requirements.txt`**: A list of Python packages required for the project.
